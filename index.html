<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Reading, manipulating, writing and plotting spatiotemporal arrays (raster and vector data cubes) in R, using GDAL bindings provided by sf, and NetCDF bindings by ncmeta and RNetCDF.">
<title>Spatiotemporal Arrays, Raster and Vector Data Cubes • stars</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Spatiotemporal Arrays, Raster and Vector Data Cubes">
<meta property="og:description" content="Reading, manipulating, writing and plotting spatiotemporal arrays (raster and vector data cubes) in R, using GDAL bindings provided by sf, and NetCDF bindings by ncmeta and RNetCDF.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">stars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/stars1.html">1. introduction</a>
    <a class="dropdown-item" href="articles/stars2.html">2. stars proxy objects</a>
    <a class="dropdown-item" href="articles/stars3.html">3. stars tidyverse methods</a>
    <a class="dropdown-item" href="articles/stars4.html">4. stars data model</a>
    <a class="dropdown-item" href="articles/stars5.html">5. vector-raster conversions, reprojection, warping</a>
    <a class="dropdown-item" href="articles/stars6.html">6. How `raster` functions map to `stars` functions</a>
    <a class="dropdown-item" href="articles/stars7.html">7. Statistical modelling with stars objects</a>
    <a class="dropdown-item" href="articles/stars8.html">8. NetCDF Proxy Workflows</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/stars/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="spatiotemporal-arrays-raster-and-vector-datacubes">Spatiotemporal Arrays: Raster and Vector Datacubes<a class="anchor" aria-label="anchor" href="#spatiotemporal-arrays-raster-and-vector-datacubes"></a>
</h1></div>
<!-- badges: start -->

<p>Spatiotemporal data often comes in the form of dense arrays, with space and time being array dimensions. Examples include</p>
<ul>
<li>socio-economic or demographic data,</li>
<li>environmental variables monitored at fixed stations,</li>
<li>raster maps</li>
<li>time series of satellite images with multiple spectral bands,</li>
<li>spatial simulations, and</li>
<li>climate or weather model output.</li>
</ul>
<p>This R package provides classes and methods for reading, manipulating, plotting and writing such data cubes, to the extent that there are proper formats for doing so.</p>
<div class="section level2">
<h2 id="raster-and-vector-data-cubes">Raster and vector data cubes<a class="anchor" aria-label="anchor" href="#raster-and-vector-data-cubes"></a>
</h2>
<p>The canonical data cube most of us have in mind is that where two dimensions represent spatial raster dimensions, and the third time (or band), as e.g. shown here:</p>
<p><img src="https://raw.githubusercontent.com/r-spatial/stars/main/images/cube1.png" width="50%"></p>
<p>By data cubes however we also consider higher-dimensional cubes (hypercubes) such as a five-dimensional cube where in addition to time, spectral band and sensor form dimensions:</p>
<p><img src="https://raw.githubusercontent.com/r-spatial/stars/main/images/cube2.png" width="50%"></p>
<p>or lower-dimensional cubes such as a raster image:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span>
<span><span class="co"># Loading required package: abind</span></span>
<span><span class="co"># Loading required package: sf</span></span>
<span><span class="co"># Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</span></span>
<span><span class="va">tif</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="va">tif</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span>index <span class="op">=</span> <span class="fl">1</span>, along <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot1-1.png"><!-- --></p>
<p>Raster data do not need to be regular and aligned with North/East, and package <code>stars</code> supports besides <em>regular</em> also <em>rotated</em>, <em>sheared</em>, <em>rectilinear</em> and <em>curvilinear</em> rasters:</p>
<p><img src="reference/figures/README-plot2-1.png"><!-- --></p>
<p>Vector data cubes arise when we do not have two regularly discretized spatial dimensions, but a single dimension that points to distinct spatial feature geometries, such as polygons (e.g. denoting administrative regions):</p>
<p><img src="https://raw.githubusercontent.com/r-spatial/stars/main/images/cube3.png" width="50%"></p>
<p>or points (e.g. denoting sensor locations):</p>
<p><img src="https://raw.githubusercontent.com/r-spatial/stars/main/images/cube4.png" width="50%"></p>
<p>NetCDF’s CF-convention calls this a <a href="https://cfconventions.org/Data/cf-conventions/cf-conventions-1.8/cf-conventions.html#discrete-axis" class="external-link">discrete axis</a>.</p>
</div>
<div class="section level2">
<h2 id="netcdf-gdal">NetCDF, GDAL<a class="anchor" aria-label="anchor" href="#netcdf-gdal"></a>
</h2>
<p><code>stars</code> provides two functions to read data: <code>read_ncdf</code> and <code>read_stars</code>, where the latter reads through GDAL. (In the future, both will be integrated in <code>read_stars</code>.) For reading NetCDF files, package <code>RNetCDF</code> is used, for reading through GDAL, package <code>sf</code> provides the binary linking to GDAL.</p>
<p>For vector and raster operations, <code>stars</code> uses as much as possible the routines available in GDAL and PROJ (e.g. <code>st_transform</code>, <code>rasterize</code>, <code>polygonize</code>, <code>warp</code>). Read more about this in the vignette on <a href="https://r-spatial.github.io/stars/articles/stars5.html" class="external-link">vector-raster conversions, reprojection, warping</a>.</p>
</div>
<div class="section level2">
<h2 id="out-of-memory-on-disk-rasters">Out-of-memory (on-disk) rasters<a class="anchor" aria-label="anchor" href="#out-of-memory-on-disk-rasters"></a>
</h2>
<p>Package <code>stars</code> provides <code>stars_proxy</code> objects (currently only when read through GDAL), which contain only the dimensions metadata and pointers to the files on disk. These objects work lazily: reading and processing data is postponed to the moment that pixels are really needed (at plot time, or when writing to disk), and is done at the lowest spatial resolution possible that still fulfills the resolution of the graphics device. More details are found in the <a href="https://r-spatial.github.io/stars/articles/stars2.html" class="external-link">stars proxy vignette</a>.</p>
<p>The following methods are currently available for <code>stars_proxy</code> objects:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"stars_proxy"</span><span class="op">)</span></span>
<span><span class="co">#  [1] [               [[&lt;-            [&lt;-             adrop          </span></span>
<span><span class="co">#  [5] aggregate       aperm           as.data.frame   c              </span></span>
<span><span class="co">#  [9] coerce          dim             droplevels      filter         </span></span>
<span><span class="co"># [13] hist            image           initialize      is.na          </span></span>
<span><span class="co"># [17] Math            merge           mutate          Ops            </span></span>
<span><span class="co"># [21] plot            predict         print           pull           </span></span>
<span><span class="co"># [25] rename          select          show            slice          </span></span>
<span><span class="co"># [29] slotsFromS3     split           st_apply        st_as_sf       </span></span>
<span><span class="co"># [33] st_as_stars     st_crop         st_dimensions&lt;- st_downsample  </span></span>
<span><span class="co"># [37] st_mosaic       st_normalize    st_redimension  st_sample      </span></span>
<span><span class="co"># [41] st_set_bbox     transmute       write_stars    </span></span>
<span><span class="co"># see '?methods' for accessing help and source code</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="raster-and-vector-time-series-analysis-example">Raster and vector time series analysis example<a class="anchor" aria-label="anchor" href="#raster-and-vector-time-series-analysis-example"></a>
</h2>
<p>In the following, a curvilinear grid with hourly precipitation values of a hurricane is imported and the first 12 time steps are plotted:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prec_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"nc/test_stageiv_xyt.nc"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">prec</span> <span class="op">=</span> <span class="fu"><a href="reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/gdal.html" class="external-link">gdal_subdatasets</a></span><span class="op">(</span><span class="va">prec_file</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co"># attribute(s):</span></span>
<span><span class="co">#                                         Min. 1st Qu. Median     Mean 3rd Qu.</span></span>
<span><span class="co"># Total_precipitation_surface... [kg/m^2]    0       0   0.75 4.143009    4.63</span></span>
<span><span class="co">#                                           Max.</span></span>
<span><span class="co"># Total_precipitation_surface... [kg/m^2] 163.75</span></span>
<span><span class="co"># dimension(s):</span></span>
<span><span class="co">#      from  to                  offset   delta         refsys</span></span>
<span><span class="co"># x       1  87                      NA      NA WGS 84 (CRS84)</span></span>
<span><span class="co"># y       1 118                      NA      NA WGS 84 (CRS84)</span></span>
<span><span class="co"># time    1  23 2018-09-13 19:00:00 UTC 1 hours        POSIXct</span></span>
<span><span class="co">#                                  values x/y</span></span>
<span><span class="co"># x    [87x118] -80.61 [°],...,-74.88 [°] [x]</span></span>
<span><span class="co"># y      [87x118] 32.44 [°],...,37.62 [°] [y]</span></span>
<span><span class="co"># time                               NULL    </span></span>
<span><span class="co"># curvilinear grid</span></span>
<span><span class="co"># or: (prec = read_ncdf(prec_file, curvilinear = c("lon", "lat"), ignore_bounds = TRUE))</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span>, <span class="st">"nc.gpkg"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">nc</span> <span class="co"># transform from NAD27 to WGS84</span></span>
<span><span class="va">nc_outline</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html" class="external-link">st_union</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot_hook</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc_outline</span>, border <span class="op">=</span> <span class="st">'red'</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">prec</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span>index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, along <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span>downsample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, hook <span class="op">=</span> <span class="va">plot_hook</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot3-1.png"><!-- --></p>
<p>and next, intersected with with the counties of North Carolina, where the maximum precipitation intensity was obtained per county, and plotted:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="reference/aggregate.stars.html">aggregate</a></span><span class="op">(</span><span class="va">prec</span>, by <span class="op">=</span> <span class="va">nc</span>, FUN <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">a</span>, max.plot <span class="op">=</span> <span class="fl">23</span>, border <span class="op">=</span> <span class="st">'grey'</span>, lwd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot4-1.png"><!-- --></p>
<p>We can integrate over (reduce) time, for instance to find out <em>when</em> the maximum precipitation occurred. The following code finds the time index, and then the corresponding time value:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_max</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="reference/st_apply.html">st_apply</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"geom"</span>, <span class="va">index_max</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>when <span class="op">=</span> <span class="fu"><a href="reference/st_dimensions.html">st_get_dimension_values</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"time"</span><span class="op">)</span><span class="op">[</span><span class="va">b</span><span class="op">$</span><span class="va">index_max</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span>key.pos <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"time of maximum precipitation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot5-1.png"><!-- --></p>
<p>With package <code>cubble</code>, we can make a glyph map to see the magnitude and timings of county maximum precipitation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/huizezhang-sherry/cubble" class="external-link">cubble</a></span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Attaching package: 'cubble'</span></span>
<span><span class="co"># The following object is masked from 'package:stats':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="st">"precip"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/st_dimensions.html">st_set_dimensions</a></span><span class="op">(</span><span class="fl">2</span>, name <span class="op">=</span> <span class="st">"tm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/drop_units.html" class="external-link">drop_units</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cubble/man/as_cubble.html" class="external-link">as_cubble</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">id</span>, index <span class="op">=</span> <span class="va">tm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">a.cb</span></span>
<span><span class="va">a.cb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cubble/man/face.html" class="external-link">face_temporal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cubble/man/unfold.html" class="external-link">unfold</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x_major <span class="op">=</span> <span class="va">long</span>, x_minor <span class="op">=</span> <span class="va">tm</span>, y_major <span class="op">=</span> <span class="va">lat</span>, y_minor <span class="op">=</span> <span class="va">precip</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nc</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cubble/man/glyph.html" class="external-link">geom_glyph_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, height <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cubble/man/glyph.html" class="external-link">geom_glyph</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, height <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co"># Warning: There were 84 warnings in `dplyr::mutate()`.</span></span>
<span><span class="co"># The first warning was:</span></span>
<span><span class="co"># ℹ In argument: `y = .data$y_major + rescale11(.data$y_minor) * .data$height/2`.</span></span>
<span><span class="co"># ℹ In group 12: `group = 12`.</span></span>
<span><span class="co"># Caused by warning in `min()`:</span></span>
<span><span class="co"># ! no non-missing arguments to min; returning Inf</span></span>
<span><span class="co"># ℹ Run `dplyr::last_dplyr_warnings()` to see the 83 remaining warnings.</span></span>
<span><span class="co"># Warning: Removed 966 rows containing missing values or values outside the scale range</span></span>
<span><span class="co"># (`geom_glyph_box()`).</span></span>
<span><span class="co"># Warning: Removed 966 rows containing missing values or values outside the scale range</span></span>
<span><span class="co"># (`geom_glyph()`).</span></span></code></pre></div>
<p><img src="reference/figures/README-plot6-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="other-packages-for-data-cubes">Other packages for data cubes<a class="anchor" aria-label="anchor" href="#other-packages-for-data-cubes"></a>
</h2>
<div class="section level3">
<h3 id="gdalcubes">
<a href="https://github.com/appelmar/gdalcubes" class="external-link"><code>gdalcubes</code></a><a class="anchor" aria-label="anchor" href="#gdalcubes"></a>
</h3>
<p>Package <code>gdalcubes</code> can be used to create data cubes (or functions from them) from image collections, sets of multi-band images with varying</p>
<ul>
<li>spatial resolution</li>
<li>spatial extent</li>
<li>coordinate reference systems (e.g., spread over multiple UTM zones)</li>
<li>observation times</li>
</ul>
<p>and does this by resampling and/or aggregating over space and/or time. It reuses GDAL VRT’s and gdalwarp for spatial resampling and/or warping, and handles temporal resampling or aggregation itself.</p>
</div>
<div class="section level3">
<h3 id="ncdfgeom">
<a href="https://github.com/DOI-USGS/ncdfgeom" class="external-link"><code>ncdfgeom</code></a><a class="anchor" aria-label="anchor" href="#ncdfgeom"></a>
</h3>
<p><code>ncdfgeom</code> reads and writes vector data cubes from and to netcdf files in a standards-compliant way.</p>
</div>
<div class="section level3">
<h3 id="raster-and-terra">
<a href="https://github.com/rspatial/raster/" class="external-link"><code>raster</code></a> and <a href="https://github.com/rspatial/terra/" class="external-link"><code>terra</code></a>
<a class="anchor" aria-label="anchor" href="#raster-and-terra"></a>
</h3>
<p>Packages <code>raster</code> and its successor, <code>terra</code> are powerful packages for handling raster maps and stacks of raster maps both in memory and on disk, but do not address</p>
<ul>
<li>non-raster time series,</li>
<li>multi-attribute rasters time series</li>
<li>rasters with mixed type attributes (e.g., numeric, logical, factor, POSIXct)</li>
<li>rectilinear or curvilinear rasters</li>
</ul>
<p>A list of <code>stars</code> commands matching existing <code>raster</code> commands is found in this <a href="https://github.com/r-spatial/stars/wiki/How-%60raster%60-functions-map-to-%60stars%60-functions" class="external-link">wiki</a>. A list of translations in the opposite direction (from <code>stars</code> to <code>raster</code> or <code>terra</code>) still needs to be made.</p>
<p>A comment on the differences between <code>stars</code> and <code>terra</code> is found <a href="https://github.com/r-spatial/stars/issues/633" class="external-link">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-stars-resources">Other <code>stars</code> resources:<a class="anchor" aria-label="anchor" href="#other-stars-resources"></a>
</h2>
<ul>
<li>blog posts: <a href="https://r-spatial.org/r/2017/11/23/stars1.html" class="external-link">first</a>, <a href="https://r-spatial.org/r/2018/03/22/stars2.html" class="external-link">second</a>, <a href="https://r-spatial.org/r/2018/03/23/stars3.html" class="external-link">third</a>, and <a href="https://r-spatial.org/" class="external-link">newer blog posts</a>
</li>
<li><a href="https://r-spatial.github.io/stars/articles/" class="external-link">vignettes</a></li>
<li>the original <a href="https://github.com/r-spatial/stars/blob/main/PROPOSAL.md" class="external-link">R Consortium proposal</a>.</li>
</ul>
<div class="section level3">
<h3 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h3>
<p>This project has been realized with financial <a href="https://www.r-consortium.org/blog/2017/04/03/q1-2017-isc-grants" class="external-link">support</a> from the</p>
<p><a href="https://www.r-consortium.org/all-projects/awarded-projects/2017-group-1" class="external-link"> <img src="http://pebesma.staff.ifgi.de/RConsortium_Horizontal_Pantone.png" width="300"></a></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=stars" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/r-spatial/stars/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/r-spatial/stars/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>Apache License</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing stars</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Edzer Pebesma <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8049-7069" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/r-spatial/stars/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/r-spatial/stars/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=stars" class="external-link"><img src="https://www.r-pkg.org/badges/version/stars" alt="CRAN"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_stars.html" class="external-link"><img src="https://badges.cranchecks.info/worst/stars.svg" alt="cran checks"></a></li>
<li><a href="https://www.r-pkg.org/pkg/stars" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/stars?color=brightgreen" alt="Downloads"></a></li>
<li><a href="https://CRAN.R-project.org/package=stars" class="external-link"><img src="https://tinyverse.netlify.com/badge/stars" alt="status"></a></li>
<li><a href="https://app.codecov.io/gh/r-spatial/stars?branch=main" class="external-link"><img src="https://codecov.io/gh/r-spatial/stars/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
