<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract cell values at point locations — st_extract • stars</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract cell values at point locations — st_extract"><meta name="description" content="Extract cell values at point locations"><meta property="og:description" content="Extract cell values at point locations"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/stars1.html">1. introduction</a></li>
    <li><a class="dropdown-item" href="../articles/stars2.html">2. stars proxy objects</a></li>
    <li><a class="dropdown-item" href="../articles/stars3.html">3. stars tidyverse methods</a></li>
    <li><a class="dropdown-item" href="../articles/stars4.html">4. stars data model</a></li>
    <li><a class="dropdown-item" href="../articles/stars5.html">5. vector-raster conversions, reprojection, warping</a></li>
    <li><a class="dropdown-item" href="../articles/stars6.html">6. How `raster` functions map to `stars` functions</a></li>
    <li><a class="dropdown-item" href="../articles/stars7.html">7. Statistical modelling with stars objects</a></li>
    <li><a class="dropdown-item" href="../articles/stars8.html">8. NetCDF Proxy Workflows</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/stars/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extract cell values at point locations</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/stars/blob/main/R/extract.R" class="external-link"><code>R/extract.R</code></a></small>
      <div class="d-none name"><code>st_extract.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract cell values at point locations</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stars'</span></span>
<span><span class="fu">st_extract</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">at</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  bilinear <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time_column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">at</span>, <span class="st">"time_column"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">at</span>, <span class="st">"time_col"</span><span class="op">)</span>,</span>
<span>  interpolate_time <span class="op">=</span> <span class="va">bilinear</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  resampling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nearest"</span>, <span class="st">"bilinear"</span>, <span class="st">"cubic"</span>, <span class="st">"cubicspline"</span><span class="op">)</span>,</span>
<span>  sfc_attribute <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object of class <code>stars</code> or <code>stars_proxy</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed on to <a href="aggregate.stars.html">aggregate.stars</a> when geometries are not exclusively POINT geometries</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>object of class <code>sf</code> or <code>sfc</code> with geometries, or two-column matrix with coordinate points in rows, indicating where to extract values of <code>x</code>, or a <code>stars</code> object with geometry and temporal dimensions (vector data cube)</p></dd>


<dt id="arg-bilinear">bilinear<a class="anchor" aria-label="anchor" href="#arg-bilinear"></a></dt>
<dd><p>logical; use bilinear interpolation rather than nearest neighbour?</p></dd>


<dt id="arg-time-column">time_column<a class="anchor" aria-label="anchor" href="#arg-time-column"></a></dt>
<dd><p>character or integer; name or index of a column with time or date values that will be matched to values of the first temporal dimension (matching classes <code>POSIXct</code>, <code>POSIXt</code>, <code>Date</code>, or <code>CFTime</code>), in <code>x</code>, after which this dimension is reduced. This is useful to extract data cube values along a trajectory; see https://github.com/r-spatial/stars/issues/352 .</p></dd>


<dt id="arg-interpolate-time">interpolate_time<a class="anchor" aria-label="anchor" href="#arg-interpolate-time"></a></dt>
<dd><p>logical; should time be interpolated? if FALSE, time instances are matched using the coinciding or the last preceding time in the data cube.</p></dd>


<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>function used to aggregate pixel values when geometries of <code>at</code> intersect with more than one pixel</p></dd>


<dt id="arg-resampling">resampling<a class="anchor" aria-label="anchor" href="#arg-resampling"></a></dt>
<dd><p>character; resampling method; for method cubic or cubicspline,
`stars_proxy` objects should be used and GDAL should have version &gt;= 3.10.0</p></dd>


<dt id="arg-sfc-attribute">sfc_attribute<a class="anchor" aria-label="anchor" href="#arg-sfc-attribute"></a></dt>
<dd><p>character; if <code>at</code> is of class <code>stars</code> should the aggregation be performed
for the attribute geometry rather than the dimension geometry? If <code>NULL</code> (default),
the aggregation is performed at the dimension geometries, else the name of the attribute geometry to perform the aggregation on.
If the given attribute geometry does not exist, the aggregation defaults to the dimension geometry.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>if <code>at</code> is of class <code>matrix</code>, a matrix with extracted values is returned;
if <code>at</code> is of class <code>stars</code> and a temporal dimension was passed to <code>time_column</code>,
a <code>stars</code> object with the original <code>at</code> dimensions
and the extracted values as attributes.
otherwise: if <code>x</code> has more dimensions than only x and y (raster), an
object of class <code>stars</code> with POINT geometries replacing x and y raster
dimensions, if this is not the case, an object of <code>sf</code> with extracted values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>points outside the raster are returned as <code>NA</code> values. For
large sets of points for which extraction is needed, passing a matrix as
to <code>at</code> may be much faster than passing an <code>sf</code> or <code>sfc</code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tif</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="read_stars.html">read_stars</a></span><span class="op">(</span><span class="va">tif</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pnt</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">pnt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 2 dimensions and 1 attribute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Min. 1st Qu. Median  Mean 3rd Qu. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L7_ETMs.tif    13   51.75     68 65.25   79.25  112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10 SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band        1  6                         NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band                                                      NULL</span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">pnt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 10 features and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 289232.3 ymin: 9111273 xmax: 297312.4 ymax: 9120157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: SIRGAS 2000 / UTM zone 25S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    L7_ETMs.tif.V1 L7_ETMs.tif.V2 L7_ETMs.tif.V3 L7_ETMs.tif.V4 L7_ETMs.tif.V5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              84             67             73             51            102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              63             50             41             80             81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              73             66             60            103             90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              61             52             31            108             80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              79             69             73             71             97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6              56             43             29             73             56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7              74             68             62             85            104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8              95             85             60             13             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9              62             48             34             79             73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10             78             68             71             74            112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    L7_ETMs.tif.V6                 geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              84 POINT (292954.5 9111273)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              46 POINT (292431.3 9118384)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              52 POINT (296727.8 9119773)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              38 POINT (292851.5 9115697)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              68 POINT (296791.7 9114387)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6              26 POINT (289232.3 9119293)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7              58 POINT (294882.6 9114838)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8              13 POINT (297312.4 9111919)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9              35 POINT (289854.7 9120157)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10             75 POINT (289511.7 9117396)</span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">r</span><span class="op">[</span>,,,<span class="fl">1</span><span class="op">]</span>, <span class="va">pnt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 10 features and 1 field</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 289232.3 ymin: 9111273 xmax: 297312.4 ymax: 9120157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: SIRGAS 2000 / UTM zone 25S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    L7_ETMs.tif                 geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           84 POINT (292954.5 9111273)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           63 POINT (292431.3 9118384)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           73 POINT (296727.8 9119773)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           61 POINT (292851.5 9115697)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           79 POINT (296791.7 9114387)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           56 POINT (289232.3 9119293)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           74 POINT (294882.6 9114838)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           95 POINT (297312.4 9111919)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           62 POINT (289854.7 9120157)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          78 POINT (289511.7 9117396)</span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">)</span><span class="op">)</span> <span class="co"># "at" is a matrix: return a matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]   84   67   73   51  102   84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   63   50   41   80   81   46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   73   66   60  103   90   52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]   61   52   31  108   80   38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]   79   69   73   71   97   68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   56   43   29   73   56   26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   74   68   62   85  104   58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   95   85   60   13   13   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   62   48   34   79   73   35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]   78   68   71   74  112   75</span>
<span class="r-in"><span><span class="co"># Extraction on non-POINT geometries</span></span></span>
<span class="r-in"><span><span class="va">poly</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="va">pnt</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">poly</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 2 dimensions and 1 attribute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Min.  1st Qu.   Median     Mean  3rd Qu.     Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L7_ETMs.tif  12.61357 54.78787 69.76618 66.72112 78.81806 107.9066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10 SIRGAS 2000 / UTM zone 25S FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band        1  6                         NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                 values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POLYGON ((293954.5 911127...,...,POLYGON ((290511.7 911739...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band                                                              NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extraction with time matching</span></span></span>
<span class="r-in"><span><span class="va">rdate</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">r</span><span class="op">*</span><span class="fl">2</span>, along <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dates</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rdate</span> <span class="op">=</span> <span class="fu"><a href="st_dimensions.html">st_set_dimensions</a></span><span class="op">(</span><span class="va">rdate</span>, <span class="st">"date"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pntsf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">dates</span>, geometry <span class="op">=</span> <span class="va">pnt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="fu"><a href="merge.html">split</a></span><span class="op">(</span><span class="va">rdate</span>, <span class="st">"band"</span><span class="op">)</span>, <span class="va">pntsf</span><span class="op">)</span> <span class="co"># POINT geometries</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 2 dimensions and 6 attributes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min. 1st Qu. Median   Mean 3rd Qu. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1    56   73.75  103.5 108.75   146.5  190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2    43   66.75   85.5  92.40   132.5  170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3    29   59.50   69.5  80.10   120.0  146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4    13   73.75  102.5 110.55   150.5  216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5    13   80.75  108.0 121.20   166.5  224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X6    13   44.00   69.0  74.25    95.0  168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to     offset  delta                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10         NA     NA SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date        1  2 2025-10-04 1 days                       Date    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date                                                      NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">polysf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="va">pntsf</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">st_extract</span><span class="op">(</span><span class="fu"><a href="merge.html">split</a></span><span class="op">(</span><span class="va">rdate</span>, <span class="st">"band"</span><span class="op">)</span>, <span class="va">polysf</span>, time_column <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="co"># POLYGON geometries</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 10 features and 7 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 288232.3 ymin: 9110273 xmax: 298312.4 ymax: 9121157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: SIRGAS 2000 / UTM zone 25S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X1        X2        X3        X4        X5        X6       date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   86.74235  73.34041  78.95659  59.57558 107.90662  86.68551 2025-10-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  128.05442 104.12335  87.59834 154.64110 156.04872  86.64680 2025-10-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   80.84317  69.51889  73.68789  68.72257 102.97050  79.01656 2025-10-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  143.92547 121.26812 117.35352 141.02174 184.27640 120.74896 2025-10-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   84.99715  73.55567  70.69834  51.76877  78.77188  60.54195 2025-10-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  126.98972 100.18972  83.01095 146.08226 144.47297  79.95821 2025-10-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   80.71654  68.98010  71.40930  69.38656 105.59302  79.18656 2025-10-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  192.11344 175.69852 129.11318  27.31106  27.26237  25.22714 2025-10-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   64.81101  51.57237  44.47277  71.82245  77.79326  46.09780 2025-10-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 134.47686 110.56999 102.17447 140.02693 169.27237 106.59299 2025-10-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  POLYGON ((293954.5 9111273,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  POLYGON ((293431.3 9118384,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  POLYGON ((297727.8 9119773,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  POLYGON ((293851.5 9115697,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  POLYGON ((297791.7 9114387,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  POLYGON ((290232.3 9119293,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  POLYGON ((295882.6 9114838,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  POLYGON ((298312.4 9111919,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  POLYGON ((290854.7 9120157,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 POLYGON ((290511.7 9117396,...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vdc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>rdm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, polygons <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      geometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">pnt</span>, <span class="fl">2</span><span class="op">)</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">dates</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="st_as_stars.html">st_as_stars</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geometry"</span>, <span class="st">"date"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">vdc_new</span> <span class="op">=</span> <span class="fu">st_extract</span><span class="op">(</span><span class="fu"><a href="merge.html">split</a></span><span class="op">(</span><span class="va">rdate</span>, <span class="st">"band"</span><span class="op">)</span>, <span class="va">vdc</span><span class="op">)</span><span class="op">)</span> <span class="co"># stars vector data cube</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 2 dimensions and 6 attributes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min. 1st Qu. Median   Mean 3rd Qu. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1    56   73.75  103.5 108.75   146.5  190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2    43   66.75   85.5  92.40   132.5  170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3    29   59.50   69.5  80.10   120.0  146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4    13   73.75  102.5 110.55   150.5  216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5    13   80.75  108.0 121.20   166.5  224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X6    13   44.00   69.0  74.25    95.0  168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to     offset  delta                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10         NA     NA SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date        1  2 2025-10-04 1 days                       Date    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date                                                      NULL</span>
<span class="r-in"><span><span class="fu"><a href="merge.html">merge</a></span><span class="op">(</span><span class="va">vdc_new</span>, name <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 3 dimensions and 1 attribute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Min. 1st Qu. Median   Mean 3rd Qu. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1.X2.X3.X4.X5.X6    13      62   84.5 97.875     136  224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to     offset  delta                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10         NA     NA SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date        1  2 2025-10-04 1 days                       Date    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band        1  6         NA     NA                         NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date                                                      NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band                                                 X1,...,X6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Extraction applied to the geometries inside the vector data cube (cell values)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">vdc_new2</span> <span class="op">=</span> <span class="fu">st_extract</span><span class="op">(</span><span class="fu"><a href="merge.html">split</a></span><span class="op">(</span><span class="va">rdate</span>, <span class="st">"band"</span><span class="op">)</span>, <span class="va">vdc</span>,</span></span>
<span class="r-in"><span>             sfc_attribute <span class="op">=</span> <span class="st">"polygons"</span><span class="op">)</span><span class="op">)</span> <span class="co"># stars vector data cube</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 2 dimensions and 6 attributes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Min.  1st Qu.    Median      Mean  3rd Qu.     Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1  69.40166 79.43934 109.04942 115.84515 149.1752 198.9679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2  57.68841 66.33621  90.94643  98.17146 122.4885 186.0393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3  54.82225 69.63102  83.03128  93.11446 123.9066 147.0114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4  26.95868 62.63331  72.92654  88.81582 119.3498 157.1760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5  26.96694 89.27355 109.30090 127.02705 180.5688 214.6674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X6  24.62397 60.09940  83.82858  91.14182 118.5457 176.8760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to     offset  delta                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10         NA     NA SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date        1  2 2025-10-04 1 days                       Date    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date                                                      NULL</span>
<span class="r-in"><span><span class="fu"><a href="merge.html">merge</a></span><span class="op">(</span><span class="va">vdc_new2</span>, name <span class="op">=</span> <span class="st">"band"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stars object with 3 dimensions and 1 attribute</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attribute(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Min.  1st Qu.   Median     Mean  3rd Qu.     Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1.X2.X3.X4.X5.X6  24.62397 69.45698 88.30459 102.3526 133.1578 214.6674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimension(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from to     offset  delta                     refsys point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry    1 10         NA     NA SIRGAS 2000 / UTM zone 25S  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date        1  2 2025-10-04 1 days                       Date    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band        1  6         NA     NA                         NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geometry POINT (292954.5 9111273),...,POINT (289511.7 9117396)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> date                                                      NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> band                                                 X1,...,X6</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

